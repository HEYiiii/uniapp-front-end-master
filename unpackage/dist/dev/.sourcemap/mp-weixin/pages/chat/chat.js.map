{"version":3,"sources":["uni-app:///main.js","webpack:///C:/Users/82669/Desktop/uniapp-front-end/pages/chat/chat.vue?e830","webpack:///C:/Users/82669/Desktop/uniapp-front-end/pages/chat/chat.vue?c00d","webpack:///C:/Users/82669/Desktop/uniapp-front-end/pages/chat/chat.vue?cce7","webpack:///C:/Users/82669/Desktop/uniapp-front-end/pages/chat/chat.vue?03b8","uni-app:///pages/chat/chat.vue","webpack:///C:/Users/82669/Desktop/uniapp-front-end/pages/chat/chat.vue?a2ff","webpack:///C:/Users/82669/Desktop/uniapp-front-end/pages/chat/chat.vue?d024"],"names":["createPage","Page"],"mappings":"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","file":"pages/chat/chat.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/chat/chat.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./chat.vue?vue&type=template&id=bf16e7f4&scoped=true&\"\nvar renderjs\nimport script from \"./chat.vue?vue&type=script&lang=js&\"\nexport * from \"./chat.vue?vue&type=script&lang=js&\"\nimport style0 from \"./chat.vue?vue&type=style&index=0&id=bf16e7f4&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"bf16e7f4\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/chat/chat.vue\"\nexport default component.exports","export * from \"-!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./chat.vue?vue&type=template&id=bf16e7f4&scoped=true&\"","var components = {\n  uLoading: function() {\n    return import(\n      /* webpackChunkName: \"node-modules/uview-ui/components/u-loading/u-loading\" */ \"uview-ui/components/u-loading/u-loading.vue\"\n    )\n  },\n  uGrid: function() {\n    return import(\n      /* webpackChunkName: \"node-modules/uview-ui/components/u-grid/u-grid\" */ \"uview-ui/components/u-grid/u-grid.vue\"\n    )\n  },\n  uGridItem: function() {\n    return import(\n      /* webpackChunkName: \"node-modules/uview-ui/components/u-grid-item/u-grid-item\" */ \"uview-ui/components/u-grid-item/u-grid-item.vue\"\n    )\n  },\n  uIcon: function() {\n    return import(\n      /* webpackChunkName: \"node-modules/uview-ui/components/u-icon/u-icon\" */ \"uview-ui/components/u-icon/u-icon.vue\"\n    )\n  }\n}\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var m0 = require(\"@/static/icon/add.png\")\n\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        m0: m0\n      }\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./chat.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./chat.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"content\">\r\n\t\t<view class=\"content-box\" @touchstart=\"touchstart\" id=\"content-box\" :class=\"{'content-showfn':showFunBtn}\">\r\n\t\t\t\r\n\t\t\t<view class=\"content-box-loading\" v-if=\"!loading\"><u-loading mode=\"flower\"></u-loading></view>\r\n\t\t\t<view class=\"message\" v-for=\"(item, index) in messageList\" :key=\"index\" :id=\"`msg-${item.hasBeenSentId}`\">\r\n\t\t\t\t<view class=\"message-item \" :class=\"item.isItMe ? 'right' : 'left'\">\r\n\t\t\t\t\t<image class=\"img\" :src=\"item.fromUserHeadImg\" mode=\"\" @tap=\"linkToBusinessCard(item.fromUserId)\"></image>\r\n\t\t\t\t\t<!-- contentType = 1 文本 -->\r\n\t\t\t\t\t<view class=\"content\" v-if=\"item.contentType == 1\">{{ item.content }}</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<!-- contentType = 3 图片 -->\r\n\t\t\t\t\t<view \r\n\t\t\t\t\t\tclass=\"content contentType3\" \t\r\n\t\t\t\t\t\tv-if=\"item.contentType == 3\"\r\n\t\t\t\t\t\t@tap=\"viewImg([item.content])\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<image :src=\"item.content\" class=\"img\" mode=\"widthFix\"></image>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view> \r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 底部聊天输入框 -->\r\n\t\t<view class=\"input-box\" :class=\"{ 'input-box-mpInputMargin': mpInputMargin }\">\r\n\t\t\t<view class=\"input-box-flex\">\r\n\t\t\t\t<!-- #ifndef H5 -->\r\n\t\t\t\t<!-- #endif -->\r\n\t\t\t\t<view class=\"input-box-flex-grow\"> \r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tclass=\"content\"\r\n\t\t\t\t\t\tid=\"input\"\r\n\t\t\t\t\t\tv-model=\"formData.content\"\r\n\t\t\t\t\t\t:hold-keyboard=\"true\"\r\n\t\t\t\t\t\t:confirm-type=\"'send'\"\r\n\t\t\t\t\t\t:confirm-hold=\"true\"\r\n\t\t\t\t\t\tplaceholder-style=\"color:#DDDDDD;\"\r\n\t\t\t\t\t\t:cursor-spacing=\"10\"\r\n\t\t\t\t\t\t@confirm=\"sendMsg(null)\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</view>\r\n\t\t\t\t<!-- 功能性按钮 -->\r\n\t\t\t\t<image class=\" icon_btn_add\" :src=\"require('@/static/icon/add.png')\" @tap=\"switchFun\"></image>\r\n\t\t\t\t\r\n\t\t\t<!-- 发送按钮 -->\r\n\t\t\t\t<!-- #ifdef H5 --> \r\n\t\t\t\t<button class=\"btn\" type=\"primary\" size=\"mini\" @touchend.prevent=\"sendMsg(null)\">发送</button>\r\n\t\t\t\t<!-- #endif -->\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- 功能区 -->\r\n\t\t\t<view class=\"fun-box\" :class=\"{'show-fun-box':showFunBtn}\">\r\n\t\t\t\t<u-grid :col=\"4\"  hover-class=\"contentType2-hover-class\" :border=\"false\" @click=\"clickGrid\">\r\n\t\t\t\t\t<u-grid-item v-for=\"(item, index) in funList\" :index=\"index\" :key=\"index\" bg-color=\"#eaeaea\">\r\n\t\t\t\t\t\t<u-icon :name=\"item.icon\" :size=\"52\"></u-icon>\r\n\t\t\t\t\t\t<view class=\"grid-text\">{{ item.title }}</view>\r\n\t\t\t\t\t</u-grid-item>\r\n\t\t\t\t</u-grid>\r\n\t\t\t</view>\r\n\r\n\t\t</view>\r\n\t\t\r\n\t\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tfromUserInfo: {},\r\n\t\t\tformData: {\r\n\t\t\t\tcontent: '',\r\n\t\t\t\tlimit: 15,\r\n\t\t\t\tindex: 1\r\n\t\t\t},\r\n\t\t\tmessageList: [],\r\n\t\t\tloading: true, //标识是否正在获取数据\r\n\t\t\timgHeight: '1000px',\r\n\t\t\tmpInputMargin: false, //适配微信小程序 底部输入框高度被顶起的问题\r\n\t\t\tRecorder: uni.getRecorderManager(),\r\n\t\t\tAudio: uni.createInnerAudioContext(),\r\n\t\t\tshowFunBtn:false, //是否展示功能型按钮\r\n\t\t\tAudioExam:null, //正在播放音频的实例\r\n\t\t\tfunList: [\r\n\t\t\t\t{ icon:\"photo-fill\",title:\"照片\",uploadType:[\"album\"] },\r\n\t\t\t\t{ icon:\"camera-fill\",title:\"拍摄\",uploadType:[\"camera\"] },\r\n\t\t\t],\r\n\t\t};\r\n\t},\r\n\tmethods: {\r\n\t\t//拼接消息 处理滚动\r\n\t\tasync joinData() {\r\n\t\t\tif (!this.loading) {\r\n\t\t\t\t//如果没有获取数据 即loading为false时，return 避免用户重复上拉触发加载\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.loading = false;\r\n\t\t\tconst data = await this.getMessageData();\r\n\t\t\t//获取节点信息\r\n\t\t\tconst { index } = this.formData;\r\n\t\t\tconst sel = `#msg-${index > 1 ? this.messageList[0].hasBeenSentId : data[data.length - 1].hasBeenSentId}`;\r\n\t\t\tthis.messageList = [...data, ...this.messageList];\r\n\t\t\t//填充数据后，视图会自动滚动到最上面一层然后瞬间再跳回bindScroll的指定位置 ---体验不是很好，后期优化\r\n\t\t\tthis.$nextTick(() => {\r\n\t\t\t\tthis.bindScroll(sel);\r\n\t\t\t\t//如果还有数据\r\n\t\t\t\tif (this.formData.limit >= data.length) {\r\n\t\t\t\t\tthis.formData.index++;\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tthis.loading = true;\r\n\t\t\t\t\t}, 200);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t//处理滚动\r\n\t\tbindScroll(sel, duration = 0) {\r\n\t\t\tconst query = uni.createSelectorQuery().in(this);\r\n\t\t\tquery\r\n\t\t\t\t.select(sel)\r\n\t\t\t\t.boundingClientRect(data => {\r\n\t\t\t\t\tuni.pageScrollTo({\r\n\t\t\t\t\t\tscrollTop: data && data.top - 40,\r\n\t\t\t\t\t\tduration\r\n\t\t\t\t\t});\r\n\t\t\t\t})\r\n\t\t\t\t.exec();\r\n\t\t},\r\n\t\t//获取消息\r\n\t\tgetMessageData() {\r\n\t\t\tlet getData = () => {\r\n\t\t\t\tlet arr = [];\r\n\t\t\t\tlet startIndex = (this.formData.index - 1) * this.formData.limit;\r\n\t\t\t\tlet endIndex = startIndex + this.formData.limit;\r\n\t\t\t\tfor (let i = startIndex; i < endIndex; i++) {\r\n\t\t\t\t\tconst isItMe = Math.random() > 0.5 ? true : false;\r\n\t\t\t\t\tarr.unshift({\r\n\t\t\t\t\t\thasBeenSentId: i, //已发送过去消息的id\r\n\t\t\t\t\t\tcontent: `很高兴认识你，这是第${i + 1}条消息。`,\r\n\t\t\t\t\t\tfromUserHeadImg: isItMe ? this._user_info.headImg : this.fromUserInfo.fromUserHeadImg, //用户头像\r\n\t\t\t\t\t\tfromUserId: isItMe ? this._user_info.id : this.fromUserInfo.fromUserId,\r\n\t\t\t\t\t\tisItMe, //true此条信息是我发送的 false别人发送的\r\n\t\t\t\t\t\tcreateTime: Date.now(),\r\n\t\t\t\t\t\tcontentType: 1, // 1文字文本 2语音\r\n\t\t\t\t\t\tanmitionPlay: false //标识音频是否在播放\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\treturn arr;\r\n\t\t\t};\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\tconst data = getData();\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tresolve(data);\r\n\t\t\t\t}, 500);\r\n\t\t\t});\r\n\t\t},\r\n\t\t//切换功能性按钮\r\n\t\tswitchFun(){\r\n\t\t\tthis.chatType = 'keyboard'\r\n\t\t\tthis.showFunBtn = !this.showFunBtn;\r\n\t\t\tuni.hideKeyboard()\r\n\t\t},\r\n\t\t//发送消息\r\n\t\tsendMsg(data) {\r\n\t\t\tconst params = {\r\n\t\t\t\thasBeenSentId: Date.now(), //已发送过去消息的id\r\n\t\t\t\tcontent: this.formData.content,\r\n\t\t\t\tfromUserHeadImg: this._user_info.headImg, //用户头像\r\n\t\t\t\tfromUserId: this._user_info.id,\r\n\t\t\t\tisItMe: true, //true此条信息是我发送的  false别人发送的\r\n\t\t\t\tcreateTime: Date.now(),\r\n\t\t\t\tcontentType: 1\r\n\t\t\t};\r\n\r\n\t\t\tif (data) {\r\n\t\t\t\t if(data.contentType == 3){\r\n\t\t\t\t\t//发送图片\r\n\t\t\t\t\tparams.content = data.content;\r\n\t\t\t\t\tparams.contentType = data.contentType;\r\n\t\t\t\t}\r\n\t\t\t} else if (!this.$u.trim(this.formData.content)) {\r\n\t\t\t\t//验证输入框书否为空字符传\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.messageList.push(params);\r\n\r\n\t\t\tthis.$nextTick(() => {\r\n\t\t\t\tthis.formData.content = '';\r\n\t\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\t\t\tif(params.contentType == 1){\r\n\t\t\t\t\t\tuni.pageScrollTo({\r\n\t\t\t\t\t\t\tscrollTop: 99999,\r\n\t\t\t\t\t\t\tduration: 0, //小程序如果有滚动效果 input的焦点也会随着页面滚动...\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tsetTimeout(()=>{\r\n\t\t\t\t\t\t\tuni.pageScrollTo({\r\n\t\t\t\t\t\t\t\tscrollTop: 99999,\r\n\t\t\t\t\t\t\t\tduration: 0, //小程序如果有滚动效果 input的焦点也会随着页面滚动...\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t},150)\r\n\t\t\t\t\t}\r\n\t\t\t\t// #endif\r\n\t\t\t\t\t\r\n\t\t\t\t// #ifndef MP-WEIXIN\r\n\t\t\t\t\tuni.pageScrollTo({\r\n\t\t\t\t\t\tscrollTop: 99999,\r\n\t\t\t\t\t\tduration: 100\r\n\t\t\t\t\t});\r\n\t\t\t\t// #endif\r\n\t\t\t\t\r\n\t\t\t\tif(this.showFunBtn){\r\n\t\t\t\t\tthis.showFunBtn = false;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// #ifdef MP-WEIXIN \r\n\t\t\t\tif (params.contentType == 1) {\r\n\t\t\t\t\tthis.mpInputMargin = true;\r\n\t\t\t\t} \r\n\t\t\t\t// #endif\r\n\t\t\t\t//h5浏览器并没有很好的办法控制键盘一直处于唤起状态 而且会有样式性的问题\r\n\t\t\t\t// #ifdef H5\r\n\t\t\t\tuni.hideKeyboard();\r\n\t\t\t\t// #endif\r\n\t\t\t});\r\n\t\t},\r\n\t\t//用户触摸屏幕的时候隐藏键盘\r\n\t\ttouchstart() {\r\n\t\t\tuni.hideKeyboard();\r\n\t\t},\r\n\t\t// userid 用户id\r\n\t\tlinkToBusinessCard(userId) {\r\n\t\t\tthis.$u.route({\r\n\t\t\t\turl: '',\r\n\t\t\t\tparams: {\r\n\t\t\t\t\tuserId\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\r\n\t\t//关闭动画\r\n\t\tcloseAnmition() {\r\n\t\t\tconst hasBeenSentId = this.Audio.hasBeenSentId;\r\n\t\t\tconst item = this.messageList.find(it => it.hasBeenSentId == hasBeenSentId);\r\n\t\t\titem.anmitionPlay = false;\r\n\t\t},\r\n\t\t//点击宫格时触发\r\n\t\tclickGrid(index){\r\n\t\t\tif(index == 0){\r\n\t\t\t\tthis.chooseImage(['album'])\r\n\t\t\t}else if(index == 1){\r\n\t\t\t\tthis.chooseImage(['camera'])\r\n\t\t\t}\r\n\t\t},\r\n\t\t//发送图片\r\n\t\tchooseImage(sourceType){\r\n\t\t\tuni.chooseImage({\r\n\t\t\t\tsourceType,\r\n\t\t\t\tsizeType:['compressed'], \r\n\t\t\t\tsuccess:res=>{ \r\n\t\t\t\t\tthis.showFunBtn = false;\r\n\t\t\t\t\tfor(let i = 0;i<res.tempFilePaths.length;i++){\r\n\t\t\t\t\t\tconst params = {\r\n\t\t\t\t\t\t\tcontentType: 3,\r\n\t\t\t\t\t\t\tcontent: res.tempFilePaths[i],\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis.sendMsg(params)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\t//查看大图\r\n\t\tviewImg(imgList){\r\n\t\t\tuni.previewImage({\r\n\t\t\t\turls: imgList,\r\n\t\t\t\t// #ifndef MP-WEIXIN\r\n\t\t\t\tindicator: 'number'\r\n\t\t\t\t// #endif\r\n\t\t\t});\r\n\t\t},\r\n\t},\r\n\tonPageScroll(e) {\r\n\t\tif (e.scrollTop < 50) {\r\n\t\t\tthis.joinData();\r\n\t\t}\r\n\t},\r\n\t// onNavigationBarButtonTap() {\r\n\t// \tconsole.log(\"点击了自定义按钮\");\r\n\t// \tuni.navigateTo({\r\n\t// \t\turl:'../chatList/chatList'\r\n\t// \t})\r\n\t// \t\t// this.$u.route({\r\n\t// \t\t// \ttype: 'switchTab',\r\n\t// \t\t// \turl: 'pages/chatList/chatList'\r\n\t// \t\t// });\r\n\t\t\r\n\t// },\r\n\t//返回按钮事件\r\n\t// onBackPress(e) {\r\n\t// \t//以下内容对h5不生效\r\n\t// \t//--所以如果用浏览器自带的返回按钮进行返回的时候页面不会重定向 正在寻找合适的解决方案\r\n\t// \tconsole.log(\"点击了自定义按钮\");\r\n\t// \tuni.navigateBack({\r\n\t\t\t\r\n\t// \t})\r\n\t// \treturn true;\r\n\t// },\r\n\tonLoad(info) {\r\n\t\t// { messageId,fromUserName,fromUserHeadImg } = info\r\n\t\tconst userInfo = this.firendList.filter(item => item.userId == info.fromUserId)[0];\r\n\t\tthis.fromUserInfo = {\r\n\t\t\tfromUserName: userInfo.userName,\r\n\t\t\tfromUserHeadImg: userInfo.headImg,\r\n\t\t\tfromUserId: userInfo.userId,\r\n\t\t\tmessageId: info.messageId\r\n\t\t};\r\n\r\n\t\t\r\n\t},\r\n\tonReady() {\r\n\t\t//自定义返回按钮 因为原生的返回按钮不可阻止默认事件\r\n\t\t// // #ifdef H5\r\n\t\t// const icon = document.getElementsByClassName('uni-page-head-btn')[0];\r\n\t\t// icon.style.display = 'none';\r\n\t\t// // #endif\r\n\r\n\t\tuni.setNavigationBarTitle({\r\n\t\t\ttitle: this.fromUserInfo.fromUserName\r\n\t\t});\r\n\t\tthis.joinData();\r\n\t\tuni.getSystemInfo({\r\n\t\t\tsuccess: res => {\r\n\t\t\t\tthis.imgHeight = res.windowHeight + 'px';\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\tuni.onKeyboardHeightChange(res => {\r\n\t\t\tif (res.height == 0) {\r\n\t\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\t\tthis.mpInputMargin = false;\r\n\t\t\t\t// #endif\r\n\t\t\t}else{\r\n\t\t\t\tthis.showFunBtn = false;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n @import './index.scss'\r\n</style>\r\n","import mod from \"-!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./chat.vue?vue&type=style&index=0&id=bf16e7f4&lang=scss&scoped=true&\"; export default mod; export * from \"-!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\wmgApps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./chat.vue?vue&type=style&index=0&id=bf16e7f4&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1605700076256\n      var cssReload = require(\"D:/wmgApps/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}